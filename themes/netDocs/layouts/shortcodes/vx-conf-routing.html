<p>The following configuration uses unnumbered IP addressing with the same /32 IPv4 address on multiple ports. OSPF unnumbered does not have an equivalent to RFC-5549, so you need to use an IPv4 address to bring up the adjacent OSPF neighbors, allowing you to reuse the same IP address.
<p>Follow these steps on each switch:</p>
    <ol>
    <li><p>Log into the switch as the cumulus user with the password <code>CumulusLinux!</code>:</p></li>
    <li><p>As the sudo user, edit the <code>/etc/frr/daemons</code> file in a text editor. Set <code>zebra</code>, <code>bgpd</code>, and <code>ospfd</code> to <strong>yes</strong>, and save the file. Run the <code>sudo systemctl start frr.service</code> command to restart FRR.</p>
    <pre>cumulus@switch:~$ sudo nano /etc/frr/daemons
    bgpd=yes
    ospfd=yes
    ...
    </pre></li>
    <li><p>Run the following commands:</p>
<details>
<summary>Leaf01</summary>
<pre>cumulus@switch:~$ net add loopback lo ip address 10.2.1.1/32
cumulus@Leaf01:~$ net add interface swp1 ip address 10.2.1.1/32
cumulus@Leaf01:~$ net add interface swp2 ip address 10.2.1.1/32
cumulus@Leaf01:~$ net add interface swp3 ip address 10.4.1.1/24
cumulus@Leaf01:~$ net add interface swp1 ospf network point-to-point
cumulus@Leaf01:~$ net add interface swp2 ospf network point-to-point
cumulus@Leaf01:~$ net add ospf router-id 10.2.1.1
cumulus@Leaf01:~$ net add ospf network 10.2.1.1/32 area 0.0.0.0
cumulus@Leaf01:~$ net add ospf network 10.4.1.0/24 area 0.0.0.0
cumulus@Leaf01:~$ net pending
cumulus@Leaf01:~$ net commit
</pre>
<p>These commands configure both the <code>/etc/network/interfaces</code> file and the <code>/etc/frr/frr.conf</code> file, as shown below. Instead of running the NCLU commands, you can edit the <code>/etc/network/interfaces</code> and the <code>/etc/frr/frr.conf</code> files manually.</p>
<pre>cumulus@Leaf01:~$ sudo nano /etc/network/interfaces
# The loopback network interface
auto lo
iface lo inet loopback
    address 10.2.1.1/32
# The primary network interface
auto eth0
iface eth0 inet dhcp

auto swp1
iface swp1
    address 10.2.1.1/32
    
auto swp2
iface swp2
    address 10.2.1.1/32
    
auto swp3
iface swp3
    address 10.4.1.1/24
</pre>
<pre>
cumulus@Leaf01:~$ sudo nano /etc/frr/frr.conf
    
service integrated-vtysh-config
    
interface swp1
    ip ospf network point-to-point
    
interface swp2
    ip ospf network point-to-point
    
    router-id 10.2.1.1
    
    router ospf
    ospf router-id 10.2.1.1
    network 10.2.1.1/32 area 0.0.0.0
    network 10.4.1.0/24 area 0.0.0.0
</pre>
</details>

<details>
<summary>Leaf02</summary>
<pre>cumulus@Leaf02:~$ net add loopback lo ip address 10.2.1.2/32
cumulus@Leaf02:~$ net add interface swp1 ip address 10.2.1.2/32
cumulus@Leaf02:~$ net add interface swp2 ip address 10.2.1.2/32
cumulus@Leaf02:~$ net add interface swp3 ip address 10.4.2.1/24
cumulus@Leaf02:~$ net add interface swp1 ospf network point-to-point
cumulus@Leaf02:~$ net add interface swp2 ospf network point-to-point
cumulus@Leaf02:~$ net add ospf router-id 10.2.1.2
cumulus@Leaf02:~$ net add ospf network 10.2.1.2/32 area 0.0.0.0
cumulus@Leaf02:~$ net add ospf network 10.4.2.0/24 area 0.0.0.0
cumulus@Leaf02:~$ net pending
cumulus@Leaf02:~$ net commit
</pre>
<p>These commands configure both the <code>/etc/network/interfaces</code> file and the <code>/etc/frr/frr.conf</code> file, as shown below. Instead of running the NCLU commands, you can edit the <code>/etc/network/interfaces</code> and the <code>/etc/frr/frr.conf</code> files manually.</p>
<pre>cumulus@Leaf02:~$ sudo nano /etc/network/interfaces
# The loopback network interface
auto lo
iface lo inet loopback
    address 10.2.1.2/32
# The primary network interface
auto eth0
iface eth0 inet dhcp
auto swp1
iface swp1
    address 10.2.1.2/32

auto swp2
iface swp2
    address 10.2.1.2/32

auto swp3
iface swp3
    address 10.4.2.1/24
</pre>
<pre>cumulus@Leaf02:~$ sudo nano /etc/frr/frr.conf

service integrated-vtysh-config

interface swp1
ip ospf network point-to-point

interface swp2
ip ospf network point-to-point

    router-id 10.2.1.2

    router ospf
    ospf router-id 10.2.1.2
    network 10.2.1.2/32 area 0.0.0.0  
    network 10.4.2.0/24 area 0.0.0.0
</pre>
</details>

<details> 
<summary>Spine01</summary>
<pre>cumulus@switch:~$ net add loopback lo ip address 10.2.1.3/32
cumulus@Spine01:~$ net add interface swp1 ip address 10.2.1.3/32
cumulus@Spine01:~$ net add interface swp2 ip address 10.2.1.3/32
cumulus@Spine01:~$ net add interface swp3 ip address 10.4.3.1/24
cumulus@Spine01:~$ net add interface swp1 ospf network point-to-point
cumulus@Spine01:~$ net add interface swp2 ospf network point-to-point
cumulus@Spine01:~$ net add ospf router-id 10.2.1.3
cumulus@Spine01:~$ net add ospf network 10.2.1.3/32 area 0.0.0.0
cumulus@Spine01:~$ net add ospf network 10.4.3.0/24 area 0.0.0.0
cumulus@Spine01:~$ net pending
cumulus@Spine01:~$ net commit
</pre>
<p>These commands configure both the <code>/etc/network/interfaces</code> file and the <code>/etc/frr/frr.conf</code> file, as shown below. Instead of running the NCLU commands, you can edit the <code>/etc/network/interfaces</code> and the <code>/etc/frr/frr.conf</code> files manually.</p>
<pre>cumulus@Spine01:~$ sudo nano /etc/network/interfaces
# The loopback network interface
auto lo
iface lo inet loopback
    address 10.2.1.3/32
# The primary network interface
auto eth0
iface eth0 inet dhcp

auto swp1
iface swp1
    address 10.2.1.3/32

auto swp2
iface swp2
    address 10.2.1.3/32
    
auto swp3
iface swp3
    address 10.4.3.1/24
</pre>
<pre>   
cumulus@Spine01:~$ sudo nano /etc/frr/frr.conf
    
service integrated-vtysh-config
    
interface swp1
    ip ospf network point-to-point

interface swp2
    ip ospf network point-to-point

    router-id 10.2.1.3

router ospf
    ospf router-id 10.2.1.3
    network 10.2.1.3/32 area 0.0.0.0
    network 10.4.3.0/24 area 0.0.0.0
</pre>
</li>
</details>

